<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Snacka Kubernetes - Neuvector | Linus Östberg</title>
<meta name=keywords content="security,snacka kubernetes,neuvector,kubernetes"><meta name=description content='A summary of my "Snacka Kubernetes - Neuvector i praktionen" presentation, covering some of the things I consider important when running Neuvector in production.'><meta name=author content="Linus Östberg"><link rel=canonical href=https://linus.oestberg.dev/posts/snacka-kubernetes-neuvector/><link crossorigin=anonymous href=/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as=style><link rel=icon href=https://linus.oestberg.dev/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://linus.oestberg.dev/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://linus.oestberg.dev/favicon-32x32.png><link rel=apple-touch-icon href=https://linus.oestberg.dev/apple-touch-icon.png><link rel=mask-icon href=https://linus.oestberg.dev/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://linus.oestberg.dev/posts/snacka-kubernetes-neuvector/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://linus.oestberg.dev/posts/snacka-kubernetes-neuvector/"><meta property="og:site_name" content="Linus Östberg"><meta property="og:title" content="Snacka Kubernetes - Neuvector"><meta property="og:description" content='A summary of my "Snacka Kubernetes - Neuvector i praktionen" presentation, covering some of the things I consider important when running Neuvector in production.'><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-02-20T17:08:33+01:00"><meta property="article:modified_time" content="2025-02-20T17:08:33+01:00"><meta property="article:tag" content="Security"><meta property="article:tag" content="Snacka Kubernetes"><meta property="article:tag" content="Neuvector"><meta property="article:tag" content="Kubernetes"><meta name=twitter:card content="summary"><meta name=twitter:title content="Snacka Kubernetes - Neuvector"><meta name=twitter:description content='A summary of my "Snacka Kubernetes - Neuvector i praktionen" presentation, covering some of the things I consider important when running Neuvector in production.'><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://linus.oestberg.dev/posts/"},{"@type":"ListItem","position":2,"name":"Snacka Kubernetes - Neuvector","item":"https://linus.oestberg.dev/posts/snacka-kubernetes-neuvector/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Snacka Kubernetes - Neuvector","name":"Snacka Kubernetes - Neuvector","description":"A summary of my \"Snacka Kubernetes - Neuvector i praktionen\" presentation, covering some of the things I consider important when running Neuvector in production.","keywords":["security","snacka kubernetes","neuvector","kubernetes"],"articleBody":"Snacka Kubernetes is a series of webinars presented by Conoa. This is a summary of a webinar (in Swedish) I presented on November 22nd 2024.\nSUSE Security, formerly known as Neuvector, is an open-source container security platform intended especially for Kubernetes. In the text i will use the abbreviation NV. Like any other security platform, it’s not enough to just install it: it also requires customization and active monitoring over time.\nIt can be easily installed using a helm chart with the default settings, but I recommend that you check the values to harden the setup (the values file even contains multiple MUST be set for Rancher hardened cluster comments).\nIf you are using Rancher, you need to make the decision whether you want to use the Rancher-integrated version or the stand-alone version of NV. The main difference is in regard to how to authenticate: in one case you use Rancher, in the other you use local accounts, AD, OIDC, or SAML. Personally, I prefer to use the stand-alone version as it currently allows for more fine-grained RBAC management for different teams.\nThe first thing you should do after setting up a NV instance is to active auto-scanning. It means that the program will automatically scan both running containers and the cluster nodes, providing information about all known CVEs. NV can also set up automated register scanning, providing CVE information for each layer in the scanned image.\nAs can be expected from a container security program, it is possible to both list workloads/nodes with a CVE, as well as list CVEs in a workload/node. It is also possible to “accept” specific CVEs, both globally and at the workload level.\nOne of the main functionalities of NV is it’s runtime protection. It analyses two aspects for each workload (deployment, pod etc): network and processes. The protection is based on whitelisting the allowed traffic and processes, while alerting about or blocking anything not listed. In discovery mode, NV will consider any observed traffic or process as normal and it to the whitelist. Monitor and protect in turns alerts or blocks the processes and network trafic. The modes for network traffic and processes can be set separately. In my experience, the process protection works well, but someone needs to be responsible for keeping track of any changes to the behaviour of the workload to make sure it doesn’t suddently stop working because of blocked processes or network traffic. I believe this work should be performed by the (development) team responsible for the application. They are the ones who know the most about the application.\nThe rules for the runtime protection can be managed as a namespaced CRD that can be synchronised via e.g. a GitOps system.\nThere are a couple of different types of security events that are reported by NV. Of course, any violations of the runtime security rules are listed as security events, but there are also some other built-in rules detecting suspicios activity such as nmap runs inside a container. Apart from the security events, events are also generated for e.g. vulnerability scanning results.\nIt is possible to define response rules for any events, the available responses are to send a notification to e.g. a webhook, or to put a pod in quarantine. Quarantine means that any ingress or egress traffic to the pod will be blocked, and differs from the pod killing that is common in many other container security programs. By defining response rules, you can e.g. set any container containing a certain CVE in quarantine, making sure it cannot be exploited.\nWhen it comes to configuring a NV instance, there are a couple of choices avaialble. Of course, you can configure it using the GUI (frontend) but it’s also possible to set the config in the helm chart as config maps and secrets, but that config will only be applied when the NV controller pods have been scaled to 0 replicates. It is also possible to use federation to access and federate the configuration to multiple instances. Finally, each NV instance has an API with access to all configuration and information in the Neuvector instance, e.g. scanning results.\nPersonally, I prefer to use Infrastructure as Code, and the only efficient way I’ve found to apply configuration in a running NV instance has been to write some code that will interact with the API and apply the configuration that way.\n","wordCount":"732","inLanguage":"en","datePublished":"2025-02-20T17:08:33+01:00","dateModified":"2025-02-20T17:08:33+01:00","author":[{"@type":"Person","name":"Linus Östberg"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://linus.oestberg.dev/posts/snacka-kubernetes-neuvector/"},"publisher":{"@type":"Organization","name":"Linus Östberg","logo":{"@type":"ImageObject","url":"https://linus.oestberg.dev/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://linus.oestberg.dev/ accesskey=h title="Home (Alt + H)"><img src=https://linus.oestberg.dev/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://linus.oestberg.dev/tags/ title=tags><span>tags</span></a></li><li><a href=https://linus.oestberg.dev/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Snacka Kubernetes - Neuvector</h1><div class=post-description>A summary of my "Snacka Kubernetes - Neuvector i praktionen" presentation, covering some of the things I consider important when running Neuvector in production.</div><div class=post-meta><span title='2025-02-20 17:08:33 +0100 +0100'>February 20, 2025</span>&nbsp;·&nbsp;Linus Östberg</div></header><div class=post-content><p>Snacka Kubernetes is a series of webinars presented by <a href=https://www.conoa.se/>Conoa</a>. This is a summary of a <a href="https://www.youtube.com/watch?v=e6AcCVxS9u8">webinar</a> (in Swedish) I presented on November 22nd 2024.</p><p>SUSE Security, formerly known as Neuvector, is an open-source container security platform intended especially for Kubernetes. In the text i will use the abbreviation NV. Like any other security platform, it&rsquo;s not enough to just install it: it also requires customization and active monitoring over time.</p><p>It can be easily installed using a <a href=https://github.com/neuvector/neuvector-helm>helm chart</a> with the default settings, but I recommend that you check the values to harden the setup (the values file even contains multiple <code>MUST be set for Rancher hardened cluster</code> comments).</p><p>If you are using Rancher, you need to make the decision whether you want to use the Rancher-integrated version or the stand-alone version of NV. The main difference is in regard to how to authenticate: in one case you use Rancher, in the other you use local accounts, AD, OIDC, or SAML. Personally, I prefer to use the stand-alone version as it currently allows for more fine-grained RBAC management for different teams.</p><p>The first thing you should do after setting up a NV instance is to active auto-scanning. It means that the program will automatically scan both running containers and the cluster nodes, providing information about all known CVEs. NV can also set up automated register scanning, providing CVE information for each layer in the scanned image.</p><p>As can be expected from a container security program, it is possible to both list workloads/nodes with a CVE, as well as list CVEs in a workload/node. It is also possible to &ldquo;accept&rdquo; specific CVEs, both globally and at the workload level.</p><p>One of the main functionalities of NV is it&rsquo;s runtime protection. It analyses two aspects for each workload (deployment, pod etc): network and processes. The protection is based on whitelisting the allowed traffic and processes, while alerting about or blocking anything not listed. In <code>discovery</code> mode, NV will consider any observed traffic or process as normal and it to the whitelist. Monitor and protect in turns alerts or blocks the processes and network trafic. The modes for network traffic and processes can be set separately. In my experience, the process protection works well, but someone needs to be responsible for keeping track of any changes to the behaviour of the workload to make sure it doesn&rsquo;t suddently stop working because of blocked processes or network traffic. I believe this work should be performed by the (development) team responsible for the application. They are the ones who know the most about the application.</p><p>The rules for the runtime protection can be managed as a namespaced CRD that can be synchronised via e.g. a GitOps system.</p><p>There are a couple of different types of security events that are reported by NV. Of course, any violations of the runtime security rules are listed as security events, but there are also some other built-in rules detecting suspicios activity such as nmap runs inside a container. Apart from the security events, events are also generated for e.g. vulnerability scanning results.</p><p>It is possible to define response rules for any events, the available responses are to send a notification to e.g. a webhook, or to put a pod in quarantine. Quarantine means that any ingress or egress traffic to the pod will be blocked, and differs from the pod killing that is common in many other container security programs. By defining response rules, you can e.g. set any container containing a certain CVE in quarantine, making sure it cannot be exploited.</p><p>When it comes to configuring a NV instance, there are a couple of choices avaialble. Of course, you can configure it using the GUI (frontend) but it&rsquo;s also possible to set the config in the helm chart as config maps and secrets, but that config will only be applied when the NV controller pods have been scaled to 0 replicates. It is also possible to use federation to access and federate the configuration to multiple instances. Finally, each NV instance has an <a href=https://github.com/neuvector/neuvector/blob/main/controller/api/apis.yaml>API</a> with access to all configuration and information in the Neuvector instance, e.g. scanning results.</p><p>Personally, I prefer to use Infrastructure as Code, and the only efficient way I&rsquo;ve found to apply configuration in a running NV instance has been to write some code that will interact with the API and apply the configuration that way.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://linus.oestberg.dev/tags/security/>Security</a></li><li><a href=https://linus.oestberg.dev/tags/snacka-kubernetes/>Snacka Kubernetes</a></li><li><a href=https://linus.oestberg.dev/tags/neuvector/>Neuvector</a></li><li><a href=https://linus.oestberg.dev/tags/kubernetes/>Kubernetes</a></li></ul><nav class=paginav><a class=next href=https://linus.oestberg.dev/posts/snacka-kubernetes-scs/><span class=title>Next »</span><br><span>Snacka Kubernetes - Supply Chain Security</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://linus.oestberg.dev/>Linus Östberg</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>