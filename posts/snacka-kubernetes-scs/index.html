<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Snacka Kubernetes - Supply Chain Security | Linus Östberg</title>
<meta name=keywords content="security,snacka kubernetes,supply chain security,cosign,kyverno,sigstore,kubernetes"><meta name=description content='A summary of my "Snacka Kubernetes - Supply Chain Security" presentation, with an overview of image and git commit signing.'><meta name=author content="Linus Östberg"><link rel=canonical href=https://linus.oestberg.dev/posts/snacka-kubernetes-scs/><link crossorigin=anonymous href=/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://linus.oestberg.dev/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://linus.oestberg.dev/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://linus.oestberg.dev/favicon-32x32.png><link rel=apple-touch-icon href=https://linus.oestberg.dev/apple-touch-icon.png><link rel=mask-icon href=https://linus.oestberg.dev/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://linus.oestberg.dev/posts/snacka-kubernetes-scs/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://linus.oestberg.dev/posts/snacka-kubernetes-scs/"><meta property="og:site_name" content="Linus Östberg"><meta property="og:title" content="Snacka Kubernetes - Supply Chain Security"><meta property="og:description" content='A summary of my "Snacka Kubernetes - Supply Chain Security" presentation, with an overview of image and git commit signing.'><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-02-16T07:57:14+01:00"><meta property="article:modified_time" content="2025-02-16T07:57:14+01:00"><meta property="article:tag" content="Security"><meta property="article:tag" content="Snacka Kubernetes"><meta property="article:tag" content="Supply Chain Security"><meta property="article:tag" content="Cosign"><meta property="article:tag" content="Kyverno"><meta property="article:tag" content="Sigstore"><meta name=twitter:card content="summary"><meta name=twitter:title content="Snacka Kubernetes - Supply Chain Security"><meta name=twitter:description content='A summary of my "Snacka Kubernetes - Supply Chain Security" presentation, with an overview of image and git commit signing.'><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://linus.oestberg.dev/posts/"},{"@type":"ListItem","position":2,"name":"Snacka Kubernetes - Supply Chain Security","item":"https://linus.oestberg.dev/posts/snacka-kubernetes-scs/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Snacka Kubernetes - Supply Chain Security","name":"Snacka Kubernetes - Supply Chain Security","description":"A summary of my \"Snacka Kubernetes - Supply Chain Security\" presentation, with an overview of image and git commit signing.","keywords":["security","snacka kubernetes","supply chain security","cosign","kyverno","sigstore","kubernetes"],"articleBody":"Snacka Kubernetes is a series of webinars presented by Conoa. This is a summary of a webinar (in Swedish) I presented on Febuary 14th 2025. As it was live-streamed on February 14th, the demo had a simple Valentine theme and was advertised as “why you should always sign your love greetings”.\nMost people do not verify the source of their images. It means that anyone who get write access to the container registry can freely replace the tagged images with their own. Later, when e.g. a Kubernetes cluster pulls the image, the replaced image will be used in place of the real one.\nThe best way to verify that you use only the images you have built is to sign them. There are multiple ways of doing it, but Sigstore has been emerging as one of the major players. Sigstore consists of multiple parts, e.g. a tamper-proof ledger (Rekor) for signing certificates, and a command-line tool called Cosign to perform the actual signing.\nThe Cosign tool by default connects to a public Rekor instance, meaning that some metadata about a signed image is made publicly available if you sign your image. If a private key is used for the signature, the public key will be part of the record, while an OIDC token may contain more metadata. In the cases where this is a problem, you may want to host a private Sigstore setup. Some inspiration for how to set it up can be obtained by looking at Sigstore Scaffolding.\nWhen an image is signed, there will be a signing certificate stored in the Rekor instance and a signature in the container registry. It can be verified using an admission controller with support for Sigstore signatures, e.g. Kyverno. After configuring a cluster policy for verification of e.g. a key signature, any unsigned images will be rejected.\nWhile a signed image may protect from tampering with container registries, there are many other ways to attack a supply chain, see e.g. SLSA for an overview. SLSA itself is a framework for defining the trust in a build chain, but is not a central topic for this presentation.\nNo matter how secure the build and deploy chain is, it won’t matter if the code is manipulated. It is thus important to also sign any git commits as well so their origin can be verified.\nGit has no verification of the authenticity of the commiter. It means that anyone can pretend to be someone else and push commits in the other persons name (given that they are authorised to push to the repository). In order to verify the origin of the commits, they need to be signed. Git supports signing with GPG and SSH keys out of the box. Setting up commit signing with an SSH key is very straight-forward and only requires a few steps.\nA simple setup would be:\nssh-keygen # Fill in key password, location etc in the prompts git config --global gpg.format ssh git config --global user.signingkey ~/.ssh/keyname.pub Sign commits using git commit -S, or sign commits automatically by setting git config --global commit.gpgsign true.\nIf you use Github, you can associate the SSH public key with your account to get a “Verified” marker on your signed commits. Any incorrectly signed (or optionally also unsigned) commits will have an “unverified” marker.\n","wordCount":"551","inLanguage":"en","datePublished":"2025-02-16T07:57:14+01:00","dateModified":"2025-02-16T07:57:14+01:00","author":[{"@type":"Person","name":"Linus Östberg"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://linus.oestberg.dev/posts/snacka-kubernetes-scs/"},"publisher":{"@type":"Organization","name":"Linus Östberg","logo":{"@type":"ImageObject","url":"https://linus.oestberg.dev/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://linus.oestberg.dev/ accesskey=h title="Home (Alt + H)"><img src=https://linus.oestberg.dev/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://linus.oestberg.dev/tags/ title=tags><span>tags</span></a></li><li><a href=https://linus.oestberg.dev/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Snacka Kubernetes - Supply Chain Security</h1><div class=post-description>A summary of my "Snacka Kubernetes - Supply Chain Security" presentation, with an overview of image and git commit signing.</div><div class=post-meta><span title='2025-02-16 07:57:14 +0100 +0100'>February 16, 2025</span>&nbsp;·&nbsp;Linus Östberg</div></header><div class=post-content><p>Snacka Kubernetes is a series of webinars presented by <a href=https://www.conoa.se/>Conoa</a>. This is a summary of a <a href="https://www.youtube.com/watch?v=i7pjf3Tnfxk">webinar</a> (in Swedish) I presented on Febuary 14th 2025. As it was live-streamed on February 14th, the demo had a simple Valentine theme and was advertised as &ldquo;why you should always sign your love greetings&rdquo;.</p><p>Most people do not verify the source of their images. It means that anyone who get write access to the container registry can freely replace the tagged images with their own. Later, when e.g. a Kubernetes cluster pulls the image, the replaced image will be used in place of the real one.</p><p>The best way to verify that you use only the images you have built is to sign them. There are multiple ways of doing it, but <a href=https://www.sigstore.dev/>Sigstore</a> has been emerging as one of the major players. Sigstore consists of multiple parts, e.g. a tamper-proof ledger (Rekor) for signing certificates, and a command-line tool called Cosign to perform the actual signing.</p><p>The Cosign tool by default connects to a <a href=https://rekor.sigstore.dev/>public Rekor instance</a>, meaning that some metadata about a signed image is made publicly available if you sign your image. If a private key is used for the signature, the public key will be part of the record, while an OIDC token may contain more metadata. In the cases where this is a problem, you may want to host a private Sigstore setup. Some inspiration for how to set it up can be obtained by looking at <a href=https://github.com/sigstore/scaffolding>Sigstore Scaffolding</a>.</p><p>When an image is signed, there will be a signing certificate stored in the Rekor instance and a signature in the container registry. It can be verified using an admission controller with support for Sigstore signatures, e.g. <a href=https://kyverno.io/docs/writing-policies/verify-images/sigstore/>Kyverno</a>. After configuring a cluster policy for verification of e.g. a key signature, any unsigned images will be rejected.</p><p>While a signed image may protect from tampering with container registries, there are many other ways to attack a supply chain, see e.g. <a href=https://slsa.dev/spec/v1.0/threats-overview>SLSA</a> for an overview. SLSA itself is a framework for defining the trust in a build chain, but is not a central topic for this presentation.</p><p>No matter how secure the build and deploy chain is, it won&rsquo;t matter if the code is manipulated. It is thus important to also sign any git commits as well so their origin can be verified.</p><p>Git has no verification of the authenticity of the commiter. It means that anyone can pretend to be someone else and push commits in the other persons name (given that they are authorised to push to the repository). In order to verify the origin of the commits, they need to be signed. Git supports signing with GPG and SSH keys out of the box. Setting up commit signing with an SSH key is very straight-forward and only requires a few steps.</p><p>A simple setup would be:</p><pre tabindex=0><code>ssh-keygen # Fill in key password, location etc in the prompts
git config --global gpg.format ssh
git config --global user.signingkey ~/.ssh/keyname.pub
</code></pre><p>Sign commits using <code>git commit -S</code>, or sign commits automatically by setting <code>git config --global commit.gpgsign true</code>.</p><p>If you use Github, you can <a href=https://docs.github.com/en/authentication/connecting-to-github-with-ssh/adding-a-new-ssh-key-to-your-github-account>associate the SSH public key with your account</a> to get a &ldquo;Verified&rdquo; marker on your signed commits. Any incorrectly signed (or optionally also unsigned) commits will have an &ldquo;unverified&rdquo; marker.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://linus.oestberg.dev/tags/security/>Security</a></li><li><a href=https://linus.oestberg.dev/tags/snacka-kubernetes/>Snacka Kubernetes</a></li><li><a href=https://linus.oestberg.dev/tags/supply-chain-security/>Supply Chain Security</a></li><li><a href=https://linus.oestberg.dev/tags/cosign/>Cosign</a></li><li><a href=https://linus.oestberg.dev/tags/kyverno/>Kyverno</a></li><li><a href=https://linus.oestberg.dev/tags/sigstore/>Sigstore</a></li><li><a href=https://linus.oestberg.dev/tags/kubernetes/>Kubernetes</a></li></ul><nav class=paginav><a class=prev href=https://linus.oestberg.dev/posts/snacka-kubernetes-neuvector/><span class=title>« Prev</span><br><span>Snacka Kubernetes - Neuvector</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://linus.oestberg.dev/>Linus Östberg</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>